{% extends "layout.html" %}

{% block content %}
<div class="home-container">
    <div class="row">
        <!-- ì‚¬ìš©ì ê³„ì¢Œ ì •ë³´ -->
        <div class="col-md-6 mb-4">
            <div class="card shadow-sm h-100">
                <div class="card-header bg-primary text-white">
                    <h3 class="mb-0"><i class="fas fa-wallet me-2"></i>ë‚´ ê³„ì¢Œ ì •ë³´</h3>
                </div>
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <span class="fw-bold">ë³´ìœ  ì”ì•¡</span>
                        <span class="fs-4 fw-bold text-primary">{{ user.balance }} {{ system_config.get('currency_symbol', 'CM') }}</span>
                    </div>
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <span class="fw-bold">ê³„ì •ëª…</span>
                        <span>{{ user.nickname }} ({{ user.id }})</span>
                    </div>
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <span class="fw-bold">ê°€ì…ì¼</span>
                        <span>{% if user and user.created_at %}{{ user.created_at.split()[0] }}{% else %}ê°€ì…ì¼ ì •ë³´ ì—†ìŒ{% endif %}</span>
                    </div>
                    
                    <hr>
                    
                    <div class="d-grid gap-2">
                        <a href="{{ url_for('auth.profile') }}" class="btn btn-primary">
                            <i class="fas fa-exchange-alt me-2"></i>ì†¡ê¸ˆ/ê±°ë˜ë‚´ì—­
                        </a>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- í€µ ë©”ë‰´ -->
        <div class="col-md-6 mb-4">
            <div class="card shadow-sm h-100">
                <div class="card-header bg-success text-white">
                    <h3 class="mb-0"><i class="fas fa-star me-2"></i>í€µ ë©”ë‰´</h3>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-6">
                            <a href="{{ url_for('market.index') }}" class="btn btn-outline-primary w-100 h-100 py-3">
                                <i class="fas fa-store d-block mb-2 fs-3"></i>
                                ë§ˆíŠ¸
                            </a>
                        </div>
                        <div class="col-6">
                            <a href="{{ url_for('games.index') }}" class="btn btn-outline-success w-100 h-100 py-3">
                                <i class="fas fa-gamepad d-block mb-2 fs-3"></i>
                                ê²Œì„
                            </a>
                        </div>
                        <div class="col-6">
                            <a href="{{ url_for('stocks.index') }}" class="btn btn-outline-warning w-100 h-100 py-3">
                                <i class="fas fa-chart-line d-block mb-2 fs-3"></i>
                                ì£¼ì‹
                            </a>
                        </div>
                        <div class="col-6">
                            <a href="{{ url_for('auth.logout') }}" class="btn btn-outline-primary w-100 h-100 py-3">
                                <i class="fas fa-sign-out-alt me-2"></i>
                                ë¡œê·¸ì•„ì›ƒ
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ê³µì§€ì‚¬í•­ -->
        <div class="col-md-12 mb-4">
            <div class="card shadow-sm">
                <div class="card-header bg-info text-white">
                    <h3 class="mb-0"><i class="fas fa-bullhorn me-2"></i>ê³µì§€ì‚¬í•­</h3>
                </div>
                <div class="card-body p-0">
                    <div class="list-group list-group-flush">
                        {% if notices %}
                            {% for notice in notices[:5] %}
                            <div class="list-group-item">
                                <div class="d-flex w-100 justify-content-between align-items-center">
                                    <h5 class="mb-1">{{ notice.title }}</h5>
                                    <small class="text-muted">{{ notice.timestamp.split()[0] }}</small>
                                </div>
                                <p class="mb-1">{{ notice.content }}</p>
                                <small class="text-muted">ì‘ì„±ì: {{ notice.author_id }}</small>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="list-group-item text-center py-4">
                                <p class="mb-0 text-muted">ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ì£¼ë¯¼ë“±ë¡ì¦ -->
        <div class="col-md-6 mb-4">
            <div class="card shadow-sm">
                <div class="card-header bg-dark text-white">
                    <h3 class="mb-0"><i class="fas fa-id-card me-2"></i>ë‚´ ì£¼ë¯¼ë“±ë¡ì¦</h3>
                </div>
                <div class="card-body">
                    <div class="id-card mx-auto" style="max-width: 350px; background: linear-gradient(135deg, #1e5799 0%,#2989d8 50%,#207cca 51%,#7db9e8 100%); color: white; border-radius: 10px; padding: 20px; position: relative;">
                        <div class="d-flex justify-content-between mb-3">
                            <h4 class="mb-0">ì²´ìŠ¤ì œêµ­ ì£¼ë¯¼ì¦</h4>
                            <div class="id-emblem">ğŸ›ï¸</div>
                        </div>
                        
                        <div class="row mb-3">
                            <div class="col-8">
                                <p class="mb-1"><strong>ì´ë¦„:</strong> {{ user.nickname }}</p>
                                <p class="mb-1"><strong>ID:</strong> {{ user.id }}</p>
                                <p class="mb-1"><strong>ì£¼ë¯¼ë²ˆí˜¸:</strong> {{ user.birth_date }} - {{ user.number }}</p>
                                <p class="mb-1"><strong>ë°œê¸‰ì¼:</strong> {% if user and user.created_at %}{{ user.created_at.split()[0] }}{% else %}ì •ë³´ ì—†ìŒ{% endif %}</p>
                                <p class="mb-1"><strong>ë©”ëª¨:</strong> {% if user and user.memo %}{{ user.memo }}{% else %}ì •ë³´ ì—†ìŒ{% endif %}</p>
                            </div>
                            <div class="col-4 text-center">
                                <div class="id-photo bg-light text-dark d-flex justify-content-center align-items-center" style="height: 100px; border-radius: 5px;">
                                    <i class="fas fa-user-circle fa-3x"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="id-qr mx-auto text-center">
                            {% if user %}
    {% set qr_data = 'ì•„ì´ë””: ' + user.id + '   ì´ë¦„: ' + user.nickname + '   ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸: ' + user.birth_date + '-' + (user.number|default('')) +  '   ë©”ëª¨: ' + (user.memo|default('')) %}
{% else %}
    {% set qr_data = 'ì‚¬ìš©ì ì •ë³´ ì—†ìŒ' %}
{% endif %}
                            <img src="https://api.qrserver.com/v1/create-qr-code/?size=100x100&data={{ qr_data }}" alt="QR Code" class="img-fluid" style="max-width: 100px; background: white; padding: 5px; border-radius: 5px;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ìµœê·¼ í™œë™ -->
        <div class="col-md-6 mb-4">
            <div class="card shadow-sm h-100">
                <div class="card-header bg-secondary text-white">
                    <h3 class="mb-0"><i class="fas fa-history me-2"></i>ì²´ìŠ¤ì œêµ­ í™œë™</h3>
                </div>
                <div class="card-body p-0">
                    <div class="list-group list-group-flush">
                        <div class="list-group-item">
                            <h5 class="mb-1">ë§ˆíŠ¸ ë°©ë¬¸</h5>
                            <p class="mb-1">íŠ¹ë³„ ì•„ì´í…œì„ êµ¬ë§¤í•˜ê³  í˜œíƒì„ ë°›ìœ¼ì„¸ìš”.</p>
                            <a href="{{ url_for('market.index') }}" class="btn btn-sm btn-outline-primary mt-2">ë°”ë¡œê°€ê¸°</a>
                        </div>
                        <div class="list-group-item">
                            <h5 class="mb-1">ê²Œì„ ì°¸ì—¬</h5>
                            <p class="mb-1">ë‹¤ì–‘í•œ ê²Œì„ì— ì°¸ì—¬í•˜ì—¬ ë³´ìƒì„ íšë“í•˜ì„¸ìš”.</p>
                            <a href="{{ url_for('games.index') }}" class="btn btn-sm btn-outline-success mt-2">ë°”ë¡œê°€ê¸°</a>
                        </div>
                        <div class="list-group-item">
                            <h5 class="mb-1">ì£¼ì‹ ê±°ë˜</h5>
                            <p class="mb-1">ì‹¤ì‹œê°„ ë³€ë™í•˜ëŠ” ì£¼ì‹ì„ ë§¤ë§¤í•˜ì„¸ìš”.</p>
                            <a href="{{ url_for('stocks.index') }}" class="btn btn-sm btn-outline-warning mt-2">ë°”ë¡œê°€ê¸°</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
